{% extends "admin/base.html" %}

{% block title %}Ch·ªânh s·ª≠a gi·ªù l√†m vi·ªác - Admin{% endblock %}
{% block page_title %}Ch·ªânh s·ª≠a gi·ªù l√†m vi·ªác{% endblock %}
{% block page_description %}C·∫≠p nh·∫≠t gi·ªù l√†m vi·ªác "{{ working_hour.day_label }}"{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Form Section -->
        <div class="admin-card p-6">
            <form method="POST" class="space-y-6">
                <div>
                    <label for="day_key" class="block text-sm font-medium text-gray-700 mb-2">
                        Kh√≥a ng√†y <span class="text-red-500">*</span>
                    </label>
                    <select id="day_key" name="day_key" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                        <option value="">Ch·ªçn kh√≥a ng√†y</option>
                        <option value="monday_friday" {% if working_hour.day_key == 'monday_friday' %}selected{% endif %}>monday_friday (Th·ª© 2-6)</option>
                        <option value="saturday" {% if working_hour.day_key == 'saturday' %}selected{% endif %}>saturday (Th·ª© 7)</option>
                        <option value="sunday" {% if working_hour.day_key == 'sunday' %}selected{% endif %}>sunday (Ch·ªß nh·∫≠t)</option>
                        <option value="holiday" {% if working_hour.day_key == 'holiday' %}selected{% endif %}>holiday (Ng√†y l·ªÖ)</option>
                        <option value="custom" {% if working_hour.day_key == 'custom' %}selected{% endif %}>custom (T√πy ch·ªânh)</option>
                    </select>
                    <p class="text-xs text-gray-500 mt-1">Kh√≥a duy nh·∫•t ƒë·ªÉ ƒë·ªãnh danh ng√†y l√†m vi·ªác</p>
                </div>

                <div>
                    <label for="day_label" class="block text-sm font-medium text-gray-700 mb-2">
                        Nh√£n hi·ªÉn th·ªã <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="day_label" name="day_label" required value="{{ working_hour.day_label }}"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                           placeholder="V√≠ d·ª•: Th·ª© 2 - Th·ª© 6, Th·ª© 7, Ch·ªß nh·∫≠t">
                    <p class="text-xs text-gray-500 mt-1">T√™n ng√†y hi·ªÉn th·ªã tr√™n website</p>
                </div>

                <div>
                    <label for="hours" class="block text-sm font-medium text-gray-700 mb-2">
                        Gi·ªù l√†m vi·ªác <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="hours" name="hours" required value="{{ working_hour.hours }}"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                           placeholder="V√≠ d·ª•: 7:00 - 17:00, 7:30 - 11:30, Ngh·ªâ">
                    <p class="text-xs text-gray-500 mt-1">Gi·ªù l√†m vi·ªác ho·∫∑c tr·∫°ng th√°i (Ngh·ªâ, ƒê√≥ng c·ª≠a)</p>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="order_index" class="block text-sm font-medium text-gray-700 mb-2">
                            Th·ª© t·ª± hi·ªÉn th·ªã
                        </label>
                        <input type="number" id="order_index" name="order_index" min="0" value="{{ working_hour.order_index }}"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                        <p class="text-xs text-gray-500 mt-1">S·ªë nh·ªè hi·ªÉn th·ªã tr∆∞·ªõc</p>
                    </div>

                    <div class="flex items-end">
                        <label class="flex items-center">
                            <input type="checkbox" id="is_active" name="is_active" {% if working_hour.is_active %}checked{% endif %}
                                   class="h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded">
                            <span class="ml-2 text-sm text-gray-700">Hi·ªÉn th·ªã tr√™n website</span>
                        </label>
                    </div>
                </div>

                <div class="flex items-center justify-between pt-6">
                    <a href="{{ url_for('admin_working_hours') }}" 
                       class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition duration-200">
                        <i class="fas fa-arrow-left mr-2"></i>Quay l·∫°i
                    </a>
                    
                    <button type="submit"
                            class="btn-primary px-6 py-3 rounded-lg hover:bg-orange-600 transition duration-200">
                        <i class="fas fa-save mr-2"></i>C·∫≠p nh·∫≠t gi·ªù l√†m vi·ªác
                    </button>
                </div>
            </form>
        </div>

        <!-- Preview Section -->
        <div class="admin-card p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Xem tr∆∞·ªõc</h3>
            
            <div class="bg-gray-50 p-6 rounded-lg">
                <div class="flex items-center mb-4">
                    <i class="fas fa-clock text-blue-600 text-2xl mr-3"></i>
                    <div>
                        <div id="preview-label" class="font-semibold text-gray-800">{{ working_hour.day_label }}</div>
                        <div id="preview-hours" class="text-lg font-bold text-blue-600">{{ working_hour.hours }}</div>
                    </div>
                </div>
            </div>

            <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                <h4 class="font-medium text-blue-800 mb-2">üí° G·ª£i √Ω:</h4>
                <ul class="text-sm text-blue-700 space-y-1">
                    <li>‚Ä¢ S·ª≠ d·ª•ng format: "7:00 - 17:00" cho gi·ªù l√†m vi·ªác</li>
                    <li>‚Ä¢ D√πng "Ngh·ªâ" ho·∫∑c "ƒê√≥ng c·ª≠a" cho ng√†y kh√¥ng l√†m vi·ªác</li>
                    <li>‚Ä¢ Th·ª© t·ª± hi·ªÉn th·ªã: 1, 2, 3... (nh·ªè h∆°n l√™n tr∆∞·ªõc)</li>
                    <li>‚Ä¢ Kh√≥a ng√†y n√™n ng·∫Øn g·ªçn v√† duy nh·∫•t</li>
                </ul>
            </div>

            <div class="mt-6 p-4 bg-gray-100 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">V√≠ d·ª• ph·ªï bi·∫øn:</h4>
                <div class="text-sm text-gray-600 space-y-1">
                    <div><strong>Th·ª© 2 - Th·ª© 6:</strong> 7:00 - 17:00</div>
                    <div><strong>Th·ª© 7:</strong> 7:30 - 11:30</div>
                    <div><strong>Ch·ªß nh·∫≠t:</strong> Ngh·ªâ</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Update preview when form fields change
    function updatePreview() {
        const label = document.getElementById('day_label').value;
        const hours = document.getElementById('hours').value;
        
        document.getElementById('preview-label').textContent = label;
        document.getElementById('preview-hours').textContent = hours;
    }
    
    // Auto-fill day_label based on day_key selection
    document.getElementById('day_key').addEventListener('change', function() {
        const dayKey = this.value;
        const dayLabelInput = document.getElementById('day_label');
        const hoursInput = document.getElementById('hours');
        
        // Only auto-fill if current values are empty or match default patterns
        if (!dayLabelInput.value || dayLabelInput.value.includes('Th·ª©') || dayLabelInput.value.includes('Ch·ªß nh·∫≠t')) {
            switch(dayKey) {
                case 'monday_friday':
                    dayLabelInput.value = 'Th·ª© 2 - Th·ª© 6';
                    if (!hoursInput.value || hoursInput.value === 'Ngh·ªâ') {
                        hoursInput.value = '7:00 - 17:00';
                    }
                    break;
                case 'saturday':
                    dayLabelInput.value = 'Th·ª© 7';
                    if (!hoursInput.value || hoursInput.value === 'Ngh·ªâ') {
                        hoursInput.value = '7:30 - 11:30';
                    }
                    break;
                case 'sunday':
                    dayLabelInput.value = 'Ch·ªß nh·∫≠t';
                    hoursInput.value = 'Ngh·ªâ';
                    break;
                case 'holiday':
                    dayLabelInput.value = 'Ng√†y l·ªÖ';
                    hoursInput.value = 'Ngh·ªâ';
                    break;
            }
            updatePreview();
        }
    });
    
    // Add event listeners
    document.getElementById('day_label').addEventListener('input', updatePreview);
    document.getElementById('hours').addEventListener('input', updatePreview);
    
    // Initial preview update
    updatePreview();
});
</script>
{% endblock %}
