{% extends "admin/base.html" %}

{% block title %}Cài đặt - Admin{% endblock %}
{% block page_title %}Cài đặt hệ thống{% endblock %}
{% block page_description %}Cấu hình và thiết lập website{% endblock %}

{% block content %}
<!-- Quick Access Links -->
<div class="mb-6">
    <h2 class="text-2xl font-bold text-gray-800 mb-4">
        <i class="fas fa-tachometer-alt mr-2 text-blue-500"></i>
        Truy cập nhanh
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- External Images -->
        <a href="{{ url_for('admin_external_images_settings') }}" 
           class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 border-l-4 border-blue-500">
            <div class="flex items-center">
                <div class="p-3 bg-blue-100 rounded-full mr-4">
                    <i class="fas fa-link text-blue-600 text-xl"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-800">Hình ảnh URL</h3>
                    <p class="text-sm text-gray-600">Google Drive, OneDrive...</p>
                </div>
            </div>
        </a>

        <!-- Themes -->
        <a href="{{ url_for('admin_themes') }}" 
           class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 border-l-4 border-purple-500">
            <div class="flex items-center">
                <div class="p-3 bg-purple-100 rounded-full mr-4">
                    <i class="fas fa-palette text-purple-600 text-xl"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-800">Themes</h3>
                    <p class="text-sm text-gray-600">Màu sắc & giao diện</p>
                </div>
            </div>
        </a>

        <!-- Homepage -->
        <a href="{{ url_for('admin_homepage') }}" 
           class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 border-l-4 border-green-500">
            <div class="flex items-center">
                <div class="p-3 bg-green-100 rounded-full mr-4">
                    <i class="fas fa-home text-green-600 text-xl"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-800">Trang chủ</h3>
                    <p class="text-sm text-gray-600">Nội dung & layout</p>
                </div>
            </div>
        </a>

        <!-- Features -->
        <a href="{{ url_for('admin_features') }}" 
           class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 border-l-4 border-orange-500">
            <div class="flex items-center">
                <div class="p-3 bg-orange-100 rounded-full mr-4">
                    <i class="fas fa-star text-orange-600 text-xl"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-800">Features</h3>
                    <p class="text-sm text-gray-600">Tính năng nổi bật</p>
                </div>
            </div>
        </a>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <div class="admin-card p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-6">Thông tin trường</h2>
        <form method="POST" action="{{ url_for('admin_settings') }}" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Tên trường</label>
                <input type="text" name="school_name" value="{{ settings.school_name if settings else 'Trường Mầm non Hoa Hướng Dương' }}" 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Địa chỉ</label>
                <textarea name="school_address" rows="2" 
                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500" required>{{ settings.school_address if settings else '123 Đường Hoa Hướng Dương, Quận 1, TP.HCM' }}</textarea>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Điện thoại</label>
                <input type="text" name="school_phone" value="{{ settings.school_phone if settings else '028-3823-4567' }}" 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                <input type="email" name="school_email" value="{{ settings.school_email if settings else 'info@hoahuongduong.edu.vn' }}" 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500" required>
            </div>
            <button type="submit" class="btn-primary px-4 py-2 rounded-md">
                <i class="fas fa-save mr-2"></i>Lưu thay đổi
            </button>
        </form>
    </div>
    
    <div class="admin-card p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-6">Cài đặt website</h2>
        <form method="POST" action="{{ url_for('admin_settings') }}" class="space-y-4">
            <!-- Hidden inputs để không mất dữ liệu thông tin trường khi submit form này -->
            <input type="hidden" name="school_name" value="{{ settings.school_name if settings else 'Trường Mầm non Hoa Hướng Dương' }}">
            <input type="hidden" name="school_address" value="{{ settings.school_address if settings else '123 Đường Hoa Hướng Dương, Quận 1, TP.HCM' }}">
            <input type="hidden" name="school_phone" value="{{ settings.school_phone if settings else '028-3823-4567' }}">
            <input type="hidden" name="school_email" value="{{ settings.school_email if settings else 'info@hoahuongduong.edu.vn' }}">
            
            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                    <p class="font-medium text-gray-800">Chế độ bảo trì</p>
                    <p class="text-sm text-gray-600">Tạm thời ẩn website khỏi người dùng</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" name="maintenance_mode" value="1" 
                           {% if settings and settings.maintenance_mode %}checked{% endif %} 
                           class="sr-only peer">
                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-500"></div>
                </label>
            </div>
            
            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                    <p class="font-medium text-gray-800">Cho phép đăng ký</p>
                    <p class="text-sm text-gray-600">Cho phép phụ huynh đăng ký online</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" name="allow_registration" value="1"
                           {% if not settings or settings.allow_registration %}checked{% endif %}
                           class="sr-only peer">
                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-500"></div>
                </label>
            </div>
            
            <button type="submit" class="btn-primary px-4 py-2 rounded-md w-full">
                <i class="fas fa-save mr-2"></i>Lưu cài đặt website
            </button>
            
            <div class="p-3 bg-blue-50 rounded-lg">
                <p class="font-medium text-blue-800 mb-2">Phiên bản hiện tại</p>
                <p class="text-sm text-blue-600">{{ settings.website_version if settings else 'v1.0.0' }} - Phiên bản Demo</p>
                <p class="text-xs text-blue-500 mt-1">Cập nhật lần cuối: {{ settings.updated_at.strftime('%d/%m/%Y') if settings and settings.updated_at else '31/07/2024' }}</p>
            </div>
        </form>
    </div>
</div>

<!-- Help & Documentation -->
<div class="mt-8">
    <h2 class="text-2xl font-bold text-gray-800 mb-4">
        <i class="fas fa-question-circle mr-2 text-green-500"></i>
        Trợ giúp & Tài liệu
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- External Images Help -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <div class="flex items-center mb-3">
                <i class="fas fa-link text-blue-600 text-2xl mr-3"></i>
                <h3 class="font-semibold text-gray-800">Hình ảnh từ URL</h3>
            </div>
            <p class="text-sm text-gray-600 mb-3">
                Sử dụng hình ảnh từ Google Drive, OneDrive thay vì upload trực tiếp để tiết kiệm dung lượng server.
            </p>
            <a href="{{ url_for('admin_external_images_settings') }}" 
               class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                Xem hướng dẫn chi tiết →
            </a>
        </div>

        <!-- Editor Help -->
        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
            <div class="flex items-center mb-3">
                <i class="fas fa-edit text-green-600 text-2xl mr-3"></i>
                <h3 class="font-semibold text-gray-800">TinyMCE Editor</h3>
            </div>
            <p class="text-sm text-gray-600 mb-3">
                Trong editor, khi chọn Insert Image, bạn có thể chọn upload file hoặc sử dụng URL từ cloud storage.
            </p>
            <span class="text-green-600 text-sm font-medium">
                Hỗ trợ: Google Drive, OneDrive, Dropbox, Imgur
            </span>
        </div>

        <!-- Performance Tips -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
            <div class="flex items-center mb-3">
                <i class="fas fa-rocket text-yellow-600 text-2xl mr-3"></i>
                <h3 class="font-semibold text-gray-800">Tối ưu hiệu suất</h3>
            </div>
            <p class="text-sm text-gray-600 mb-3">
                Khuyến nghị sử dụng hình ảnh từ cloud storage để giảm tải server và tăng tốc độ website.
            </p>
            <span class="text-yellow-600 text-sm font-medium">
                Tiết kiệm đến 90% dung lượng server
            </span>
        </div>
    </div>
</div>
{% endblock %}