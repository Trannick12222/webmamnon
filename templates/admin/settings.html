{% extends "admin/base.html" %}

{% block title %}Cài đặt - Admin{% endblock %}
{% block page_title %}Cài đặt hệ thống{% endblock %}
{% block page_description %}Cấu hình và thiết lập website{% endblock %}

{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <div class="admin-card p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-6">Thông tin trường</h2>
        <form method="POST" action="{{ url_for('admin_settings') }}" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Tên trường</label>
                <input type="text" name="school_name" value="{{ settings.school_name if settings else 'Trường Mầm non Hoa Hướng Dương' }}" 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Địa chỉ</label>
                <textarea name="school_address" rows="2" 
                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500" required>{{ settings.school_address if settings else '123 Đường Hoa Hướng Dương, Quận 1, TP.HCM' }}</textarea>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Điện thoại</label>
                <input type="text" name="school_phone" value="{{ settings.school_phone if settings else '028-3823-4567' }}" 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                <input type="email" name="school_email" value="{{ settings.school_email if settings else 'info@hoahuongduong.edu.vn' }}" 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500" required>
            </div>
            <button type="submit" class="btn-primary px-4 py-2 rounded-md">
                <i class="fas fa-save mr-2"></i>Lưu thay đổi
            </button>
        </form>
    </div>
    
    <div class="admin-card p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-6">Cài đặt website</h2>
        <form method="POST" action="{{ url_for('admin_settings') }}" class="space-y-4">
            <!-- Hidden inputs để không mất dữ liệu thông tin trường khi submit form này -->
            <input type="hidden" name="school_name" value="{{ settings.school_name if settings else 'Trường Mầm non Hoa Hướng Dương' }}">
            <input type="hidden" name="school_address" value="{{ settings.school_address if settings else '123 Đường Hoa Hướng Dương, Quận 1, TP.HCM' }}">
            <input type="hidden" name="school_phone" value="{{ settings.school_phone if settings else '028-3823-4567' }}">
            <input type="hidden" name="school_email" value="{{ settings.school_email if settings else 'info@hoahuongduong.edu.vn' }}">
            
            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                    <p class="font-medium text-gray-800">Chế độ bảo trì</p>
                    <p class="text-sm text-gray-600">Tạm thời ẩn website khỏi người dùng</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" name="maintenance_mode" value="1" 
                           {% if settings and settings.maintenance_mode %}checked{% endif %} 
                           class="sr-only peer">
                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-500"></div>
                </label>
            </div>
            
            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                    <p class="font-medium text-gray-800">Cho phép đăng ký</p>
                    <p class="text-sm text-gray-600">Cho phép phụ huynh đăng ký online</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" name="allow_registration" value="1"
                           {% if not settings or settings.allow_registration %}checked{% endif %}
                           class="sr-only peer">
                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-500"></div>
                </label>
            </div>
            
            <button type="submit" class="btn-primary px-4 py-2 rounded-md w-full">
                <i class="fas fa-save mr-2"></i>Lưu cài đặt website
            </button>
            
            <div class="p-3 bg-blue-50 rounded-lg">
                <p class="font-medium text-blue-800 mb-2">Phiên bản hiện tại</p>
                <p class="text-sm text-blue-600">{{ settings.website_version if settings else 'v1.0.0' }} - Phiên bản Demo</p>
                <p class="text-xs text-blue-500 mt-1">Cập nhật lần cuối: {{ settings.updated_at.strftime('%d/%m/%Y') if settings and settings.updated_at else '31/07/2024' }}</p>
            </div>
        </form>
    </div>
</div>
{% endblock %}